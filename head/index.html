<!DOCTYPE html>
<html class="ui-mobile"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>nEDM Base</title> 
	
	<link rel="stylesheet" href="../../../nedm%2Fhead/_design/nedm_head/style/jquery.mobile-1.1.1.css" />
	<script src="../../../nedm%2Fhead/_design/nedm_head/scripts/jquery-1.9.0.js"></script>
	<script src="modules.js"></script>
	<script src="../../../nedm%2Fhead/_design/nedm_head/scripts/nedm-base.js"></script>
	<script src="../../../nedm%2Fhead/_design/nedm_head/scripts/jquery.mobile-1.3.1.js"></script>
	<script src="../../../nedm%2Fhead/_design/nedm_head/scripts/dygraph-combined.js"></script>
	<style> .center { text-align: center; } </style>

    <script>
    // We build the list of DBs to point to.  This is simply subsystems
    var dict_of_dbs = {}
    function buildDBList() {
       if ($('#listofdbs').length == 0) return;
       $.getJSON('_rewrite/_couchdb/_all_dbs', function(data) {
           var html ='';
           var patt = /^nedm\//;
           var number_of_current_dbs = Object.keys(dict_of_dbs).length;
           $.each(data, function(key, val) {
               if (patt.exec(val) != null) {
                   var db_name = val.substring(5);
                   if (db_name == 'head') return;
                   if (db_name in dict_of_dbs) return;
                   dict_of_dbs[db_name] = [];
                   var esc_name = val.replace("\/", "%2F"); 
                   html += '<li><a href="_rewrite/_couchdb/' + esc_name + 
                       '/_design/nedm_default/index.html">' + db_name + '</a></li>';
               }       
           });
           $('#listofdbs').append($(html));
           if (number_of_current_dbs == 0) {
               $('#listofdbs').trigger('create');
           } else { 
               //$('#listofdbs').listview('refresh');
           }
       }); 
    }
    </script>

</head> 

<body class="ui-mobile-viewport ui-overlay-c"> 

    <!--<div id="standardHeader">
        <div data-role="header" data-position="fixed" data-theme="b">
            <h1>nEDM Interface</h1>
            <a href="#login" data-rel="dialog" class="ui-btn-right">Login</a>
        </div>
    </div> -->


<!-- Start of splash page: #one -->

<div data-role="page" id="base_home">
    <div class="headerChild"> 
    </div>

    <!--<div class="headerKid">
    </div>
    <script>$('headerKid').load('./index.html #standardHeader');</script> -->
    <div align="center" data-role="content" id="contentConfirmation" name="contentConfirmation">
        <h1>Subsystems</h1>
        <ul data-role="listview" id="listofdbs">
        </ul>
    </div>
</div>
<script>
    $("#base_home").on('pageinit', function(event, ui) {
      buildDBList(); 
    });
</script>




</body>
</html>
